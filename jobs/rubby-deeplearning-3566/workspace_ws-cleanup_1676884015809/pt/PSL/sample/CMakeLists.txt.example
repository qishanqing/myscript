cmake_minimum_required(VERSION 3.0.0)
set(PROJECT_NAME detector_sample)
project(${PROJECT_NAME} VERSION 1.1.3)
add_definitions(-std=c++11)

set(ROOT_DIR ${CMAKE_CURRENT_LIST_DIR}/)
add_executable(${PROJECT_NAME} main.cpp)

set(DETECTOR_DIR ${CMAKE_CURRENT_BINARY_DIR}/../)

# glog
target_link_libraries(${PROJECT_NAME} -lpthread -lglog)

# opencv
find_package(OpenCV REQUIRED)
target_link_libraries(${PROJECT_NAME} ${OpenCV_LIBS})

# eigen
find_package(Eigen3 REQUIRED NO_MODULE)
include_directories(${EIGEN3_INCLUDE_DIRS})

# npu
set(NPU_LIBRARIES -lovxlib)
target_link_libraries(${PROJECT_NAME}  ${NPU_LIBRARIES})

# yaml-cpp
target_link_libraries(${PROJECT_NAME} -lyaml-cpp)

# deep learning modules
include_directories(/usr/local/include/I18RPublicBaseTypes)
include_directories(${DETECTOR_DIR}/include)
message(STATUS "build on processor: ${CMAKE_HOST_SYSTEM_PROCESSOR}")
set(detector ${DETECTOR_DIR}/lib/libdetector.so)
target_link_libraries(${PROJECT_NAME} ${detector} -ldl)
set_target_properties(${PROJECT_NAME} PROPERTIES LINK_FLAGS -Wl,--no-as-needed)

execute_process(COMMAND cp -r ${ROOT_DIR}/../config ${CMAKE_BINARY_DIR})
