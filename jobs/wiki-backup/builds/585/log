Started by timer
Running as SYSTEM
Building remotely on [8mha:////4GJECaSXI5jaa88kGHMmbEkdCg31N4g4yVAlsCFwflHgAAAAmR+LCAAAAAAAAP9b85aBtbiIQTGjNKU4P08vOT+vOD8nVc83PyU1x6OyILUoJzMv2y+/JJUBAhiZGBgqihhk0NSjKDWzXb3RdlLBUSYGJk8GtpzUvPSSDB8G5tKinBIGIZ+sxLJE/ZzEvHT94JKizLx0a6BxUmjGOUNodHsLgAzmEgZe/eT83ILSktQifUNLQwA4ziQnwgAAAA==[0m191 (192.168.50.191) in workspace /home/indemind/.jenkins_slave/workspace/wiki-backup
[WS-CLEANUP] Deleting project workspace...
[WS-CLEANUP] Deferred wipeout is used...
[WS-CLEANUP] Done
[wiki-backup] $ /bin/sh -xe /tmp/jenkins10030822196928446517.sh
+ source /home/indemind/myscript/sh/confluence_backup.sh
++ source /etc/profile
+++ '[' '' ']'
+++ '[' -d /etc/profile.d ']'
+++ for i in '/etc/profile.d/*.sh'
+++ '[' -r /etc/profile.d/appmenu-qt5.sh ']'
+++ . /etc/profile.d/appmenu-qt5.sh
++++ export QT_QPA_PLATFORMTHEME=appmenu-qt5
++++ QT_QPA_PLATFORMTHEME=appmenu-qt5
+++ for i in '/etc/profile.d/*.sh'
+++ '[' -r /etc/profile.d/apps-bin-path.sh ']'
+++ . /etc/profile.d/apps-bin-path.sh
++++ snap_bin_path=/snap/bin
++++ '[' -n /usr/lib/jvm/jdk-11/bin:/usr/lib/jvm/jdk-11/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games -a -n /usr/lib/jvm/jdk-11/bin:/usr/lib/jvm/jdk-11/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games ']'
++++ export PATH=/usr/lib/jvm/jdk-11/bin:/usr/lib/jvm/jdk-11/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
++++ PATH=/usr/lib/jvm/jdk-11/bin:/usr/lib/jvm/jdk-11/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
++++ '[' -z '' ']'
++++ export XDG_DATA_DIRS=/usr/local/share:/usr/share
++++ XDG_DATA_DIRS=/usr/local/share:/usr/share
++++ snap_xdg_path=/var/lib/snapd/desktop
++++ '[' -n /usr/local/share:/usr/share -a -n /usr/local/share:/usr/share ']'
++++ export XDG_DATA_DIRS=/usr/local/share:/usr/share:/var/lib/snapd/desktop
++++ XDG_DATA_DIRS=/usr/local/share:/usr/share:/var/lib/snapd/desktop
+++ for i in '/etc/profile.d/*.sh'
+++ '[' -r /etc/profile.d/bash_completion.sh ']'
+++ . /etc/profile.d/bash_completion.sh
++++ '[' -n '4.3.48(1)-release' -a -n '' -a -z '' ']'
+++ for i in '/etc/profile.d/*.sh'
+++ '[' -r /etc/profile.d/cedilla-portuguese.sh ']'
+++ . /etc/profile.d/cedilla-portuguese.sh
++++ '[' '' = pt -a zh '!=' pt ']'
+++ for i in '/etc/profile.d/*.sh'
+++ '[' -r /etc/profile.d/vte-2.91.sh ']'
+++ . /etc/profile.d/vte-2.91.sh
++++ '[' -n '4.3.48(1)-release' -o -n '' ']'
++++ [[ ehxB == *i* ]]
++++ return 0
+++ unset i
+++ LANG=zh_CN.UTF-8
+++ LANGUAGE=zh_CN:en_US:en
+++ LC_CTYPE=zh_CN.UTF-8
+++ LC_NUMERIC=zh_CN.UTF-8
+++ LC_TIME=zh_CN.UTF-8
+++ LC_COLLATE=zh_CN.UTF-8
+++ LC_MONETARY=zh_CN.UTF-8
+++ LC_MESSAGES=zh_CN.UTF-8
+++ LC_PAPER=zh_CN.UTF-8
+++ LC_NAME=zh_CN.UTF-8
+++ LC_ADDRESS=zh_CN.UTF-8
+++ LC_TELEPHONE=zh_CN.UTF-8
+++ LC_MEASUREMENT=zh_CN.UTF-8
+++ LC_IDENTIFICATION=zh_CN.UTF-8
+++ LC_ALL=
+++ export JAVA_HOME=/usr/lib/jvm/jdk-11
+++ JAVA_HOME=/usr/lib/jvm/jdk-11
+++ export JRE_HOME=//usr/lib/jvm/jdk-11/jre
+++ JRE_HOME=//usr/lib/jvm/jdk-11/jre
+++ export CLASSPATH=.:/usr/lib/jvm/jdk-11/lib://usr/lib/jvm/jdk-11/jre/lib
+++ CLASSPATH=.:/usr/lib/jvm/jdk-11/lib://usr/lib/jvm/jdk-11/jre/lib
+++ export M2_HOME=/usr/local/apache-maven-3.6.3
+++ M2_HOME=/usr/local/apache-maven-3.6.3
+++ export PATH=.:/usr/lib/jvm/jdk-11/bin:/usr/local/apache-maven-3.6.3/bin:/usr/lib/jvm/jdk-11/bin:/usr/lib/jvm/jdk-11/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
+++ PATH=.:/usr/lib/jvm/jdk-11/bin:/usr/local/apache-maven-3.6.3/bin:/usr/lib/jvm/jdk-11/bin:/usr/lib/jvm/jdk-11/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
+++ export PATH=.:/usr/lib/jvm/jdk-11/bin:/usr/local/apache-maven-3.6.3/bin:/usr/lib/jvm/jdk-11/bin:/usr/lib/jvm/jdk-11/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/usr/local/gcc-linaro-5.4.1-2017.01-x86_64_aarch64-linux-gnu/bin
+++ PATH=.:/usr/lib/jvm/jdk-11/bin:/usr/local/apache-maven-3.6.3/bin:/usr/lib/jvm/jdk-11/bin:/usr/lib/jvm/jdk-11/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/usr/local/gcc-linaro-5.4.1-2017.01-x86_64_aarch64-linux-gnu/bin
+++ export PATH=.:/usr/lib/jvm/jdk-11/bin:/usr/local/apache-maven-3.6.3/bin:/usr/lib/jvm/jdk-11/bin:/usr/lib/jvm/jdk-11/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/usr/local/gcc-linaro-5.4.1-2017.01-x86_64_aarch64-linux-gnu/bin:/home/indemind/myscript/sh
+++ PATH=.:/usr/lib/jvm/jdk-11/bin:/usr/local/apache-maven-3.6.3/bin:/usr/lib/jvm/jdk-11/bin:/usr/lib/jvm/jdk-11/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/usr/local/gcc-linaro-5.4.1-2017.01-x86_64_aarch64-linux-gnu/bin:/home/indemind/myscript/sh
++ wiki_backup_dir=/data/docker/wiki/etc/backups
++ wiki_backup_mysql=wiki
++ wiki_backup_mysql_path=/data/backup/mysql
+++ date +%Y-%m-%d-%H-%M
++ wiki_backup_mysql_name=wiki-2024-09-26-23-50.sql
+++ date +%Y-%m-%d-%H-%M
++ indemind_backup_mysql_name=indemind-2024-09-26-23-50.sql
++ confluence_sys_upload
++ cd /data/docker/wiki/etc/backups
++ sudo chmod 755 backup-2024_09_24.zip backup-2024_09_25.zip backup-2024_09_26.zip
+++ ls -lt
+++ awk '{if ($9) printf("%s\n",$9)}'
+++ head -n 1
++ targes=backup-2024_09_26.zip
++ upload-to-ftp -t -d backup-2024_09_26.zip ftp://guest:guest@192.168.50.158/wiki/
+ export BUILD_ID=dontkillme
+ BUILD_ID=dontkillme
+++ basename /home/indemind/myscript/sh/upload-to-ftp
++ getopt -o tfd: --long dir: -n upload-to-ftp -- -t -d backup-2024_09_26.zip ftp://guest:guest@192.168.50.158/wiki/
+ TEMP=' -t -d '\''backup-2024_09_26.zip'\'' -- '\''ftp://guest:guest@192.168.50.158/wiki/'\'''
+ dir=
+ todo=
+ eval set -- ' -t -d '\''backup-2024_09_26.zip'\'' -- '\''ftp://guest:guest@192.168.50.158/wiki/'\'''
++ set -- -t -d backup-2024_09_26.zip -- ftp://guest:guest@192.168.50.158/wiki/
+ true
+ case "$1" in
+ todo=put
+ shift
+ true
+ case "$1" in
+ dir=backup-2024_09_26.zip
+ shift 2
+ true
+ case "$1" in
+ shift
+ break
+ test 1 = 0 -o -z backup-2024_09_26.zip
++ basename backup-2024_09_26.zip
+ filename=backup-2024_09_26.zip
++ dirname backup-2024_09_26.zip
++ echo -n backup-2024_09_26.zip
++ perl -npe 's,\.\d+\.tmp$,,'
+ name=./backup-2024_09_26.zip
+ test -f backup-2024_09_26.zip
+ name=backup-2024_09_26.zip
+ for ftp in '"$@"'
++ echo ftp://guest:guest@192.168.50.158/wiki/
++ perl -npe 's,.*?//.*?/,,'
+ ftp_dir=wiki/
+ test ''
++ echo ftp://guest:guest@192.168.50.158/wiki/
++ perl -npe 's,^(.*?//.*?/).*,$1,'
+ ftp_host=ftp://guest:guest@192.168.50.158/
+ (( n = 0 ))
+ (( n < 3 ))
+ lftp -c 'connect ftp://guest:guest@192.168.50.158/;
                set ssl:verify-certificate no;
		cd wiki/ &&  put '\''backup-2024_09_26.zip'\'''

real	9m56.869s
user	0m38.989s
sys	2m7.639s
+ break
++ confluence_data_upload
++ confluence_data_backup
++ mysqldump -uroot -p123 wiki
mysqldump: [Warning] Using a password on the command line interface can be insecure.
++ mysqldump -uroot -p123 wiki
mysqldump: [Warning] Using a password on the command line interface can be insecure.
++ cd /data/backup/mysql
++ upload-to-ftp -t -d wiki-2024-09-26-23-50.sql ftp://guest:guest@192.168.50.158/mysql/
+ export BUILD_ID=dontkillme
+ BUILD_ID=dontkillme
+++ basename /home/indemind/myscript/sh/upload-to-ftp
++ getopt -o tfd: --long dir: -n upload-to-ftp -- -t -d wiki-2024-09-26-23-50.sql ftp://guest:guest@192.168.50.158/mysql/
+ TEMP=' -t -d '\''wiki-2024-09-26-23-50.sql'\'' -- '\''ftp://guest:guest@192.168.50.158/mysql/'\'''
+ dir=
+ todo=
+ eval set -- ' -t -d '\''wiki-2024-09-26-23-50.sql'\'' -- '\''ftp://guest:guest@192.168.50.158/mysql/'\'''
++ set -- -t -d wiki-2024-09-26-23-50.sql -- ftp://guest:guest@192.168.50.158/mysql/
+ true
+ case "$1" in
+ todo=put
+ shift
+ true
+ case "$1" in
+ dir=wiki-2024-09-26-23-50.sql
+ shift 2
+ true
+ case "$1" in
+ shift
+ break
+ test 1 = 0 -o -z wiki-2024-09-26-23-50.sql
++ basename wiki-2024-09-26-23-50.sql
+ filename=wiki-2024-09-26-23-50.sql
++ dirname wiki-2024-09-26-23-50.sql
++ echo -n wiki-2024-09-26-23-50.sql
++ perl -npe 's,\.\d+\.tmp$,,'
+ name=./wiki-2024-09-26-23-50.sql
+ test -f wiki-2024-09-26-23-50.sql
+ name=wiki-2024-09-26-23-50.sql
+ for ftp in '"$@"'
++ echo ftp://guest:guest@192.168.50.158/mysql/
++ perl -npe 's,.*?//.*?/,,'
+ ftp_dir=mysql/
+ test ''
++ echo ftp://guest:guest@192.168.50.158/mysql/
++ perl -npe 's,^(.*?//.*?/).*,$1,'
+ ftp_host=ftp://guest:guest@192.168.50.158/
+ (( n = 0 ))
+ (( n < 3 ))
+ lftp -c 'connect ftp://guest:guest@192.168.50.158/;
                set ssl:verify-certificate no;
		cd mysql/ &&  put '\''wiki-2024-09-26-23-50.sql'\'''

real	0m11.700s
user	0m0.658s
sys	0m1.563s
+ break
++ upload-to-ftp -t -d indemind-2024-09-26-23-50.sql ftp://guest:guest@192.168.50.158/mysql/
+ export BUILD_ID=dontkillme
+ BUILD_ID=dontkillme
+++ basename /home/indemind/myscript/sh/upload-to-ftp
++ getopt -o tfd: --long dir: -n upload-to-ftp -- -t -d indemind-2024-09-26-23-50.sql ftp://guest:guest@192.168.50.158/mysql/
+ TEMP=' -t -d '\''indemind-2024-09-26-23-50.sql'\'' -- '\''ftp://guest:guest@192.168.50.158/mysql/'\'''
+ dir=
+ todo=
+ eval set -- ' -t -d '\''indemind-2024-09-26-23-50.sql'\'' -- '\''ftp://guest:guest@192.168.50.158/mysql/'\'''
++ set -- -t -d indemind-2024-09-26-23-50.sql -- ftp://guest:guest@192.168.50.158/mysql/
+ true
+ case "$1" in
+ todo=put
+ shift
+ true
+ case "$1" in
+ dir=indemind-2024-09-26-23-50.sql
+ shift 2
+ true
+ case "$1" in
+ shift
+ break
+ test 1 = 0 -o -z indemind-2024-09-26-23-50.sql
++ basename indemind-2024-09-26-23-50.sql
+ filename=indemind-2024-09-26-23-50.sql
++ dirname indemind-2024-09-26-23-50.sql
++ echo -n indemind-2024-09-26-23-50.sql
++ perl -npe 's,\.\d+\.tmp$,,'
+ name=./indemind-2024-09-26-23-50.sql
+ test -f indemind-2024-09-26-23-50.sql
+ name=indemind-2024-09-26-23-50.sql
+ for ftp in '"$@"'
++ echo ftp://guest:guest@192.168.50.158/mysql/
++ perl -npe 's,.*?//.*?/,,'
+ ftp_dir=mysql/
+ test ''
++ echo ftp://guest:guest@192.168.50.158/mysql/
++ perl -npe 's,^(.*?//.*?/).*,$1,'
+ ftp_host=ftp://guest:guest@192.168.50.158/
+ (( n = 0 ))
+ (( n < 3 ))
+ lftp -c 'connect ftp://guest:guest@192.168.50.158/;
                set ssl:verify-certificate no;
		cd mysql/ &&  put '\''indemind-2024-09-26-23-50.sql'\'''

real	0m11.772s
user	0m0.742s
sys	0m1.605s
+ break
Finished: SUCCESS
